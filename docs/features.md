# Xbot 機能仕様書

## 実装状況の凡例
- ✅ 実装済み
- 🔄 開発中
- ❌ 未実装

## ドキュメント管理ルール

### READMEの徹底ルール
1. 機能実装時の更新義務
   - 新機能の実装完了時に必ず更新
   - 既存機能の修正時も更新が必要
   - 実装状況の変更を即時反映

2. 更新内容
   - 実装した機能の説明
   - 技術スタックの変更
   - 設定や環境の変更
   - 依存関係の更新
   - 既知の問題点の記録

3. 更新タイミング
   - 機能実装完了時
   - バグ修正完了時
   - 設定変更時
   - 環境更新時
   - 定期的な見直し（月1回）

4. 更新項目
   - 機能仕様書の更新
   - 実装状況の更新（✅実装済み、🔄開発中、❌未実装）
   - 技術スタックの更新
   - 開発フェーズの進捗更新
   - 実装詳細の記録
   - テスト結果の記録
   - 既知の問題点の管理

5. レビュープロセス
   - 更新内容の自己レビュー
   - 変更点の確認
   - 整合性の確認
   - 必要に応じてチームレビュー

### 自動チェックシステム
1. 機能実装時の自動チェック
   - 新機能実装時のドキュメント更新チェック
   - 既存機能修正時のドキュメント更新チェック
   - 実装状況の自動更新チェック

2. プルリクエスト時のチェックリスト
   - ドキュメント更新の確認
   - 実装状況の更新確認
   - 技術スタックの変更確認
   - 設定変更の確認

3. 定期的な監査
   - 月次でのドキュメント確認
   - 実装状況の棚卸し
   - 更新漏れのチェック
   - 整合性の確認

4. 自動チェックの実行タイミング
   - コミット時
   - プルリクエスト作成時
   - マージ時
   - 定期的なバッチ実行（週1回）

5. チェック項目
   - 機能仕様書の更新状況
   - 実装状況の更新状況
   - 技術スタックの更新状況
   - 設定変更の記録
   - 既知の問題点の管理状況

## 1. トレンド分析サービス

### 1.1 YouTubeトレンド分析
- ✅ YouTube Data APIを使用した動画検索
  - キーワード検索
  - ソート順の指定（関連性、日付、評価、視聴回数）
  - 地域と言語の指定
  - 結果数の制限
  - 動画詳細情報の取得
- ✅ トレンド動画の自動収集
  - 定期的な収集（デフォルト：60分間隔）
  - 地域・カテゴリ別の収集
  - データベースへの永続化
  - 古いデータの自動削除（30日以上前）
- ✅ 視聴回数、コメント数、いいね数などの分析
  - 時系列での統計情報の追跡
  - エンゲージメント率の詳細分析
  - コメントの感情分析
  - ✅ バズり度スコアの計算
    - 視聴回数スコア（0-30点）
    - エンゲージメントスコア（0-25点）
    - コメント活性度スコア（0-20点）
    - チャンネル影響力スコア（0-15点）
    - 感情分析スコア（0-10点）
    - 合計スコア（0-100点）
- ✅ 外国人視点からの反応分析
  - 英語コメントの抽出と分析
  - 感情分析スコアの計算
  - 反応タイプの分類
  - 代表的なコメント例の抽出

### 1.2 分析機能
- ❌ キーワードベースの検索
- ❌ カテゴリ別トレンド分析
- ❌ 時系列でのトレンド変化追跡
- ❌ 地域別トレンド比較
- ❌ 言語別反応分析

### 1.3 データ管理
- ❌ 分析結果のキャッシュ
- ❌ 定期的なデータ更新
- ❌ 分析履歴の保存
- ❌ データのエクスポート機能

## 2. コンテンツ生成サービス

### 2.1 テキスト生成
- ✅ ChatGPT APIを使用した投稿文生成
- ✅ プロンプトテンプレート管理
- ✅ 生成パラメータのカスタマイズ
- ❌ 複数バリエーションの生成
- ❌ 生成履歴の管理

### 2.2 画像生成
- ❌ DALL-E APIを使用した画像生成
- ❌ 画像生成プロンプトの最適化
- ❌ 画像の編集・リサイズ
- ❌ 画像の保存と管理
- ❌ 生成画像のプレビュー

### 2.3 動画生成
- ❌ Gemini Veo3 APIを使用した動画生成
- ❌ 動画生成プロンプトの作成
- ❌ 動画パラメータの調整
- ❌ 動画の編集・トリミング
- ❌ 生成動画の保存

## 3. 投稿管理サービス

### 3.1 投稿作成
- ✅ テキスト、画像、動画の組み合わせ
- ✅ 投稿プレビュー
- ✅ 投稿内容の編集
- ✅ 投稿の下書き保存
- ❌ 投稿テンプレート管理

### 3.2 スケジューリング
- ✅ 投稿スケジュール設定
- ✅ 定期的な投稿設定
- ❌ 最適な投稿タイミングの提案
- ✅ スケジュールの管理
- ✅ 投稿履歴の表示

### 3.3 分析・レポート
- ❌ 投稿パフォーマンス分析
- ❌ エンゲージメント統計
- ❌ トレンドとの相関分析
- ❌ レポートの自動生成
- ❌ データの可視化

## 4. 設定管理サービス

### 4.1 API設定
- ✅ X API認証情報管理
- ✅ YouTube API設定
- ✅ OpenAI API設定
- ❌ Google Gemini API設定
- ❌ APIキーのローテーション

### 4.2 トレンド分析設定
- ❌ 検索条件の設定
- ❌ 分析パラメータの調整
- ❌ 更新頻度の設定
- ❌ データ保持期間の設定
- ❌ 分析対象のカスタマイズ

### 4.3 投稿テーマ設定
- ❌ カテゴリ設定
- ❌ 優先順位の管理
- ❌ 季節イベントの設定
- ❌ 投稿スタイルの設定
- ❌ テーマの自動提案

### 4.4 生成AI設定
- ❌ プロンプトテンプレート管理
- ❌ 生成パラメータの設定
- ❌ スタイル設定の管理
- ❌ 生成品質の調整
- ❌ 生成履歴の管理

## 5. 共通基盤機能

### 5.1 ロギング
- ✅ シンプルなファイルログ
- ✅ エラーログの自動保存
- ✅ ログローテーション
- ✅ ログレベルの設定
- ❌ ログの検索・分析

### 5.2 エラーハンドリング
- ✅ 基本的なエラー通知
- ✅ エラーログの記録
- ✅ 自動リトライ機能
- ❌ エラーの分類と対応
- ❌ エラー統計の収集

### 5.3 設定管理
- ✅ ローカル設定ファイル
- ✅ 環境変数による設定
- ✅ 設定のバックアップ
- ✅ 設定の検証
- ❌ 設定のバージョン管理

### 5.4 キャッシュ
- ✅ メモリキャッシュ
- ✅ ファイルキャッシュ
- ✅ キャッシュの有効期限管理
- ✅ キャッシュのクリア
- ❌ キャッシュ統計の収集

### 5.5 データベースアクセス
- ✅ コネクションプール管理
- ✅ トランザクション管理
- ✅ クエリ実行
- ✅ マイグレーション管理
- ❌ バックアップ/リストア

## 6. セキュリティとデータ管理

### 6.1 データ保護
- ✅ ローカルファイルでの保存
- ✅ 機密情報の管理
- ✅ バックアップの自動化
- ❌ データの暗号化
- ❌ アクセス制御

### 6.2 設定管理
- ✅ シークレットメモによる管理
- ✅ 設定の検証とテスト
- ✅ 設定の確認とテスト
- ✅ 設定のバックアップ
- ✅ 設定の復元

## 7. 開発・運用機能

### 7.1 開発環境
- ✅ コンテナ化（Docker）
- ✅ 開発サーバー設定
- ✅ テスト環境
- ✅ デバッグツール
- ✅ 開発用スクリプト

### 7.2 運用管理
- ✅ ログ監視
- ❌ パフォーマンスモニタリング
- ✅ エラー通知
- ✅ バックアップ管理
- ✅ システム状態の確認

### 7.3 テスト
- ✅ ユニットテスト
- ❌ 統合テスト
- ❌ E2Eテスト
- ❌ パフォーマンステスト
- ❌ セキュリティテスト

## 実装状況サマリー（2024-05-29時点）
- 実装済み: 25項目
- 開発中: 0項目
- 未実装: 70項目
- 実装率: 約26.3%

### 優先実装項目
1. トレンド分析サービスの基盤機能
   - YouTube Data API連携
   - 基本的な分析機能
   - データ管理機能

2. コンテンツ生成サービスの基盤機能
   - ChatGPT API連携
   - 基本的なテキスト生成
   - 生成履歴管理

3. 投稿管理サービスの基盤機能
   - X API連携
   - 基本的な投稿機能
   - スケジューリング機能

### 次期開発計画
1. 共通基盤機能の強化
   - ログの検索・分析機能
   - エラー統計の収集
   - キャッシュ統計の収集

2. セキュリティ機能の強化
   - データの暗号化
   - アクセス制御の実装
   - セキュリティテストの実施

3. テスト環境の整備
   - 統合テストの実装
   - E2Eテストの実装
   - パフォーマンステストの実装 