# Xbot プロジェクト

## プロジェクト概要
このプロジェクトは、X（旧Twitter）への自動投稿を生成AIが自動的にタスクをこなして対応するシステムです。AIを活用して、定期的な投稿の自動化や、特定の条件に基づいた投稿の生成・実行を行います。YouTubeのトレンド分析と外国人視点のリサーチを組み合わせ、その日のバズりトピックを元に、外国人が共感・笑えるようなニッチで親しみやすい投稿を生成します。

### 開発方針
- 個人開発者向けのシンプルなツール
- 認証機能は実装せず、ローカル環境での利用を前提
- 必要最小限の機能に絞り、メンテナンス性を重視
- 開発・運用の負担を最小限に抑える設計
- マイクロサービスアーキテクチャの採用
  - サービスごとの独立したデプロイ
  - 疎結合なサービス設計
  - スケーラブルな構成
  - サービス間の明確な境界
- モダンな開発手法の活用
  - コンテナ化（Docker）による環境の統一
  - CI/CDパイプラインの構築
  - インフラストラクチャ・アズ・コード（IaC）
  - 自動テストの徹底
  - 継続的インテグレーション
  - 継続的デリバリー
  - モニタリングとロギングの自動化
- ドキュメント管理
  - 機能実装時は必ず機能仕様書を更新
  - READMEの更新は機能実装の完了条件
  - 実装状況の可視化（✅実装済み、🔄開発中、❌未実装）
  - 技術スタックの変更は即時反映
  - 開発フェーズの進捗管理
  - 実装詳細の記録
  - テスト結果の記録
  - 既知の問題点の管理

### READMEの徹底ルール
1. 機能実装時の更新義務
   - 新機能の実装完了時に必ず更新
   - 既存機能の修正時も更新が必要
   - 実装状況の変更を即時反映

2. 更新内容
   - 実装した機能の説明
   - 技術スタックの変更
   - 設定や環境の変更
   - 依存関係の更新
   - 既知の問題点の記録

3. 更新タイミング
   - 機能実装完了時
   - バグ修正完了時
   - 設定変更時
   - 環境更新時
   - 定期的な見直し（月1回）

4. 更新項目
   - 機能仕様書の更新
   - 実装状況の更新（✅実装済み、🔄開発中、❌未実装）
   - 技術スタックの更新
   - 開発フェーズの進捗更新
   - 実装詳細の記録
   - テスト結果の記録
   - 既知の問題点の管理

5. レビュープロセス
   - 更新内容の自己レビュー
   - 変更点の確認
   - 整合性の確認
   - 必要に応じてチームレビュー

### 主な特徴
- 🤖 AIによる自動投稿生成
- 🌍 外国人視点からのコンテンツ分析
- 📈 YouTubeトレンドのリアルタイム分析
  - キーワード検索
  - ソート順の指定
  - 地域と言語の指定
  - 動画詳細情報の取得
  - ✅ トレンド動画の自動収集
    - 定期的な収集（デフォルト：60分間隔）
    - 地域・カテゴリ別の収集
    - データベースへの永続化
    - 古いデータの自動削除（30日以上前）
- 🎯 バズり予測に基づく投稿最適化
- 🔄 定期的な自動投稿スケジューリング
- 🎨 マルチメディア（テキスト、画像、動画）生成

### 価値提案
- 時間の節約：投稿の企画から実行までを自動化
- エンゲージメント向上：データに基づく最適な投稿タイミング
- グローバル視点：外国人視点を取り入れた独自性のあるコンテンツ
- トレンド対応：リアルタイムのトレンド分析と活用
- クリエイティブ支援：AIによる創造的なコンテンツ生成

### 利用制限
- 個人利用に限定
- 複数ユーザーでの利用は想定していない
- 認証機能は実装せず、ローカル環境での利用を前提
- APIキーはローカル環境で管理

## 機能仕様
詳細な機能仕様については、[機能仕様書](docs/features.md)を参照してください。

## システム構成
### サービス構成
1. トレンド分析サービス
   - 技術スタック
     - フロントエンド
       - React + TypeScript
       - Tailwind CSS
       - Jotai（状態管理）
     - バックエンド
       - FastAPI
       - YouTube Data API
         - 動画検索機能
         - 動画詳細情報取得
         - エラーハンドリング
         - テスト実装
       - 非同期処理
   - デプロイ
     - コンテナ化（Docker）
     - スケーラブルな構成
     - メトリクス収集

2. コンテンツ生成サービス
   - 技術スタック
     - フロントエンド
       - React + TypeScript
       - Tailwind CSS
       - Zustand（状態管理）
     - バックエンド
       - FastAPI
       - OpenAI API (ChatGPT, DALL-E)
       - Google Gemini API (Veo3)
   - デプロイ
     - コンテナ化（Docker）
     - GPUリソース管理
     - 生成キュー管理

3. 投稿管理サービス
   - 技術スタック
     - フロントエンド
       - React + TypeScript
       - Tailwind CSS
       - Zustand（状態管理）
     - バックエンド
       - FastAPI
       - X API
       - スケジューラー
   - デプロイ
     - コンテナ化（Docker）
     - スケジューラー機能
     - 監視システム

4. 設定管理サービス
   - 技術スタック
     - フロントエンド
       - React + TypeScript
       - Tailwind CSS
       - Zustand（状態管理）
     - バックエンド
       - FastAPI
       - ローカルストレージ
       - バックアップ管理
   - デプロイ
     - コンテナ化（Docker）
     - 永続ストレージ
     - バックアップシステム

### 共通基盤
- ロギング
  - シンプルなファイルログ
  - エラーログの自動保存
  - ログローテーション
- エラーハンドリング
  - 基本的なエラー通知
  - エラーログの記録
  - 自動リトライ機能
- 設定管理
  - ローカル設定ファイル
  - 環境変数による設定
  - 設定のバックアップ
- キャッシュ
  - メモリキャッシュ
  - ファイルキャッシュ
  - キャッシュの有効期限管理
- データベースアクセス
  - コネクションプール管理
  - トランザクション管理
  - クエリ実行
  - マイグレーション管理

### サービス間通信
- RESTful API
  - シンプルなエンドポイント
  - バージョン管理
  - 基本的なエラーハンドリング
- 非同期処理
  - バックグラウンドタスク
  - 定期的なバッチ処理
  - エラー時の再試行

### データフロー
1. トレンド分析
   - YouTube検索 → 分析 → 結果保存
2. 投稿生成
   - ネタ選択 → AI生成 → コンテンツ作成
3. 投稿実行
   - コンテンツ確認 → スケジュール → 投稿

### 画面構成
1. メニュー画面
   - ナビゲーション
     - 投稿ネタ検索
     - 投稿作成
     - 設定
   - クイックアクション
     - 新規投稿作成
     - トレンド検索
     - 設定変更

2. 設定チャット画面
   - チャットインターフェース
     - ChatGPTとの対話による設定
     - 自然な会話形式での設定
     - 設定項目の説明と提案
     - 設定値の確認と修正
   - 設定プレビューパネル（リアルタイム更新）
     - 現在の設定状態表示
     - 設定変更の差分表示
     - 設定値の検証結果
     - 設定の影響範囲表示
   - 設定カテゴリ
     - API設定
       - X API認証情報（ローカル保存）
       - YouTube API設定（ローカル保存）
       - ChatGPT API設定（ローカル保存）
     - トレンド分析設定
       - 検索条件
       - 分析パラメータ
       - 更新頻度
     - 投稿テーマ設定
       - カテゴリ選択
       - 優先順位
       - 季節イベント
     - 生成AI設定
       - プロンプトテンプレート
       - 生成パラメータ
       - スタイル設定
   - 設定確認機能
     - 設定値のプレビュー
       - 現在の設定状態
       - 変更前後の比較
       - 設定の有効範囲
     - 設定テスト実行
       - 各APIの接続テスト
       - 設定値の動作確認
       - エラー検出
     - 設定の影響確認
       - 投稿生成への影響
       - パフォーマンスへの影響
       - コストへの影響
   - 設定履歴と変更管理
     - 過去の設定変更履歴
     - 設定のバックアップ
     - 設定の復元
   - 設定の確認とテスト
     - 設定値のプレビュー
     - テスト実行
     - エラー確認

3. 投稿ネタ検索画面
   - トレンド分析ツール
     - YouTube検索実行ボタン
       - 手動検索トリガー
       - 検索条件の選択
       - 検索結果の表示
     - 検索結果一覧
       - 動画タイトル
       - 視聴回数
       - コメント数
       - 外国人反応
     - 分析結果
       - バズり度スコア
       - 外国人反応分析
       - 投稿アイデア提案
   - 投稿ネタ選択機能
     - ネタの詳細表示
       - 動画内容の要約
       - 外国人反応の詳細
       - バズり要素の分析
     - ネタの評価
       - 面白さ評価
       - 共感度評価
       - 投稿適性評価
     - ネタの選択
       - 単一ネタ選択
       - 複数ネタの比較
       - ネタの組み合わせ
   - 検索履歴
     - 過去の検索条件
     - 保存した検索結果
     - お気に入り登録
   - 投稿アイデア管理
     - アイデアの保存
     - アイデアの編集
     - アイデアの分類
   - 投稿作成への移行
     - 選択したネタの転送
     - 生成パラメータの設定
     - 投稿作成画面への遷移

4. X投稿作成画面
   - 選択したネタの表示
     - ネタの概要
     - 分析結果
     - 生成の方向性
   - 投稿内容の生成
     - ChatGPTによる投稿文生成
       - ネタをベースにした文章生成
       - プロンプトのカスタマイズ
       - 生成パラメータの調整
       - 生成結果の編集
       - 面白さ要素の自動付加
       - トレンド要素の組み込み
     - DALL-Eによる画像生成
       - ネタに基づく画像生成
       - 画像生成プロンプトの作成
       - 生成パラメータの調整
       - 生成画像のプレビュー
       - 画像の編集・リサイズ
       - 生成画像の保存
       - ユーモア要素の追加
     - Gemini Veo3による動画生成
       - ネタを活かした動画生成
       - 動画生成プロンプトの作成
       - 動画パラメータの調整
       - 動画プレビュー
       - 動画の編集・トリミング
       - 動画の保存
       - 面白さの演出設定
   - 生成コンテンツの管理
     - 生成履歴の保存
     - バリエーションの管理
     - 再利用設定
   - 投稿プレビュー
     - テキストプレビュー
     - メディアプレビュー
     - 投稿全体の確認
   - 投稿スケジュール設定
   - 投稿テスト実行

### 技術スタック
- フロントエンド
  - Vite + React + TypeScript
  - Tailwind CSS
  - Storybook
  - HERO UIライブラリ
    - デザインシステムの統一
    - 再利用可能なコンポーネント
    - アクセシビリティ対応
    - レスポンシブデザイン
    - ダークモード対応
    - アニメーション効果
    - フォーム要素の標準化
    - エラー表示の統一
    - ローディング状態の表現
    - モーダル・ダイアログの標準化
- バックエンド
  - FastAPI（各サービス）
  - 非同期処理
  - コンテナ化
- AI
  - OpenAI API
    - ChatGPT
    - DALL-E
  - Google Gemini API
    - Veo3
- YouTube Data API
- X API

### HERO UIライブラリの利用方針
#### 1. コンポーネント設計
- アトミックデザインの採用
  - Atoms: 基本的なUI要素（ボタン、インプット、アイコン）
  - Molecules: 複数のAtomsを組み合わせた複合コンポーネント
  - Organisms: 機能的な単位のコンポーネント
  - Templates: ページのレイアウト構造
  - Pages: 実際のページ実装

#### 2. スタイリング方針
- Tailwind CSSとの統合
  - カスタムテーマの設定
  - コンポーネント固有のスタイル拡張
  - ユーティリティクラスの活用
- デザインシステムの遵守
  - カラーパレットの統一
  - タイポグラフィの一貫性
  - スペーシングの標準化
  - アニメーションの統一

#### 3. アクセシビリティ対応
- WAI-ARIA準拠
- キーボードナビゲーション
- スクリーンリーダー対応
- カラーコントラストの確保

#### 4. パフォーマンス最適化
- コンポーネントの遅延ロード
- バンドルサイズの最適化
- レンダリングパフォーマンスの改善
- キャッシュ戦略の実装

#### 5. テスト戦略
- コンポーネントの単体テスト
- ビジュアルリグレッションテスト
- アクセシビリティテスト
- パフォーマンステスト

#### 6. ドキュメント化
- Storybookによるコンポーネントカタログ
- 使用例とAPI仕様
- アクセシビリティガイドライン
- パフォーマンスベンチマーク

#### 7. 品質管理
- コードレビュー基準
- パフォーマンス指標
- アクセシビリティチェックリスト
- ブラウザ互換性テスト

### セキュリティとデータ管理
- 認証: 不要（個人開発ツール）
- データ保存: ローカルファイル
  - secrets.memo.md（機密情報管理）
    - APIキー
    - アクセストークン
    - リフレッシュトークン
    - データベース接続情報
    - 開発環境設定
    - バックアップ情報
  - 設定ファイル
  - 生成履歴
- バックアップ: ローカルファイル
  - 設定のバックアップ
  - 生成コンテンツのバックアップ

### 設定管理の特徴
- シークレットメモによる管理
  - 機密情報の一元管理
    - APIキー
    - アクセストークン
    - リフレッシュトークン
    - データベース接続情報
    - 開発環境設定
    - バックアップ情報
  - Git管理からの除外
  - 定期的なバックアップ
  - アクセス制限
- 設定の検証とテスト
  - 設定値のプレビュー
    - 現在の設定状態
    - 変更前後の比較
    - 設定の有効範囲
  - テスト実行
    - 各APIの接続テスト
    - 設定値の動作確認
    - エラー検出
  - エラー確認
    - バリデーションエラー
    - 依存関係エラー
    - 整合性エラー
- 設定の確認とテスト
  - 設定値のプレビュー
    - 現在の設定状態
    - 変更前後の比較
    - 設定の有効範囲
  - テスト実行
    - 各APIの接続テスト
    - 設定値の動作確認
    - エラー検出
  - エラー確認
    - バリデーションエラー
    - 依存関係エラー
    - 整合性エラー

### 設定チャットの特徴
- 自然な会話形式での設定
  - コンテキストを理解した提案
  - 設定値の自動最適化
  - エラーの予防と解決
  - 設定の説明と学習
  - 過去の設定パターンの活用
- リアルタイムな設定確認
  - 視覚的な設定状態の把握
  - 設定変更の影響予測
  - 設定の検証とテスト
- 設定カテゴリ管理
  - API設定
    - X API認証情報
    - YouTube API設定
    - OpenAI API設定
    - Google Gemini API設定
  - トレンド分析設定
    - 検索条件
    - 分析パラメータ
    - 更新頻度
    - データ管理
  - 投稿テーマ設定
    - カテゴリ選択
    - 優先順位
    - 季節イベント
  - 生成AI設定
    - プロンプトテンプレート
    - 生成パラメータ
    - スタイル設定
- 設定の影響確認
  - 投稿生成への影響
  - パフォーマンスへの影響
  - コストへの影響
- 設定履歴と変更管理
  - 過去の設定変更履歴
  - 設定のバックアップ
  - 設定の復元

### 投稿テーマの特徴
- YouTubeトレンドの動的な分析
- 外国人視点からの反応分析
- バズり予測に基づく投稿生成
- 日常の中のユニークな発見
- 外国人が共感できる視点
- 笑いを誘う要素の組み込み
- 文化的な違いを楽しむ視点

### 設定チャットの特徴
- 自然な会話形式での設定
- コンテキストを理解した提案
- 設定値の自動最適化
- エラーの予防と解決
- 設定の説明と学習
- 過去の設定パターンの活用
- リアルタイムな設定確認
- 視覚的な設定状態の把握
- 設定変更の影響予測
- 設定の検証とテスト

### 状態管理アーキテクチャ
- Jotai
  - アトムベースの状態管理
    - 細粒度の状態分割
    - 効率的な再レンダリング
  - 非同期処理
    - 非同期アトム
    - ローディング状態の管理
    - エラーハンドリング
  - 型安全性
    - TypeScriptとの完全な統合
    - 型推論の活用
  - パフォーマンス
    - 最小限の再レンダリング
    - メモ化の自動化
  - 開発体験
    - シンプルなAPI
    - デバッグのしやすさ
    - テストの書きやすさ

### 非同期処理の実装
- サービス間通信
  - RESTful API
    - シンプルなエンドポイント
    - バージョン管理
    - 基本的なエラーハンドリング
  - 非同期処理
    - バックグラウンドタスク
    - 定期的なバッチ処理
    - エラー時の再試行
- 状態管理
  - 非同期アトム
    - データフェッチング
    - キャッシュ管理
    - エラー状態
  - 副作用管理
    - 自動再取得
    - 依存関係の追跡
    - クリーンアップ

## 開発フェーズ
### フェーズ1: 基盤構築
1. 設定管理サービス
   - 理由：
     - 他のサービスの設定を管理
     - 環境変数やAPIキーの管理
     - 基本的なファイル操作の実装
   - 実装項目：
     - ローカル設定ファイル管理
     - 環境変数管理
     - バックアップ機能
     - 基本的なエラーハンドリング

2. 共通基盤
   - 理由：
     - 全サービスで使用する共通機能
     - ロギングやエラーハンドリング
   - 実装項目：
     - ロギングシステム
     - エラーハンドリング
     - キャッシュ管理
     - 非同期処理基盤

### フェーズ2: コア機能実装
1. トレンド分析サービス
   - 理由：
     - 投稿の基となるデータ収集
     - 他のサービスへの影響が少ない
   - 実装項目：
     - ✅ YouTube API連携
       - 動画検索機能
       - 動画詳細情報取得
       - エラーハンドリング
       - テスト実装
     - 🔄 トレンド分析ロジック
     - 🔄 データキャッシュ
     - 🔄 分析結果の保存

2. コンテンツ生成サービス
   - 理由：
     - トレンド分析の結果を活用
     - 投稿作成の基盤
   - 実装項目：
     - AI API連携
     - テキスト生成
     - 画像生成
     - 動画生成

### フェーズ3: 統合と最適化
1. 投稿管理サービス
   - 理由：
     - 他のサービスの機能を統合
     - 最終的な出力を担当
   - 実装項目：
     - X API連携
     - スケジューラー
     - 投稿履歴管理
     - 分析ダッシュボード

### フェーズ4: UI/UX実装
1. フロントエンド開発
   - 理由：
     - バックエンドの機能が完成後
     - ユーザーインターフェースの実装
   - 実装項目：
     - 共通コンポーネント
     - 各サービスのUI
     - 状態管理
     - レスポンシブデザイン

### 開発の進め方
1. 各フェーズでの目標
   - フェーズ1: 基盤の安定性確保
   - フェーズ2: コア機能の動作確認
   - フェーズ3: サービス間の連携確認
   - フェーズ4: ユーザー体験の最適化

2. テスト戦略
   - 各フェーズでの単体テスト
   - サービス間の統合テスト
   - E2Eテストの実施
   - パフォーマンステスト

3. デプロイ戦略
   - フェーズごとの段階的デプロイ
   - 動作確認とロールバック計画
   - モニタリングの設定
   - バックアップの確保

4. 品質管理
   - コードレビュー
   - テストカバレッジ
   - パフォーマンス指標
   - セキュリティチェック

## 開発環境
- OS: Windows 10 (WSL2)
- コンテナ: Docker
- 開発ツール
  - VS Code
  - Git
  - Docker Desktop

## セットアップ手順
詳細なセットアップ手順については、[セットアップガイド](docs/setup.md)を参照してください。

## 開発ガイドライン
### コーディング規約
- Python: PEP 8に準拠
- JavaScript/TypeScript: ESLint + Prettier
- コミットメッセージ: Conventional Commits

### ブランチ戦略
- main: 本番環境用
- develop: 開発用
- feature/*: 機能開発用
- hotfix/*: 緊急修正用

### テスト
- ユニットテスト: 必須
- 統合テスト: 推奨
- E2Eテスト: 主要機能のみ

### レビュープロセス
1. プルリクエストの作成
2. コードレビューの依頼
3. レビューコメントへの対応
4. 承認後のマージ

## ライセンス
このプロジェクトはMITライセンスの下で公開されています。
詳細は[LICENSE](LICENSE)ファイルを参照してください。

## 貢献
1. このリポジトリをフォーク
2. 新しいブランチを作成
3. 変更をコミット
4. プルリクエストを作成

## サポート
- 問題報告: GitHub Issues
- 機能要望: GitHub Discussions
- 技術的な質問: GitHub Discussions

## 更新履歴
- 2024-05-24: プロジェクト初期化
- 2024-05-25: READMEの改善、セットアップ手順の詳細化
- 2024-05-29: 実装状況の整理、READMEの構造改善